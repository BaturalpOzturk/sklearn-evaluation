{"timestamp": 1607989698.878271, "stored_source_code": "# Tracking Machine Learning experiments\n\n`SQLiteTracker` provides a simple yet powerful way to track ML experiments using a SQLite database.\nfrom sklearn_evaluation import SQLiteTracker\n\nfrom sklearn.datasets import load_iris\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.linear_model import LinearRegression, Lasso\nfrom sklearn.svm import SVR\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error\ntracker = SQLiteTracker('my_experiments.db')\n# Parameters\nproduct = \"source/user_guide/SQLiteTracker.ipynb\"\n\niris = load_iris(as_frame=True)\nX, y = iris['data'], iris['target']\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)\n\nmodels = [RandomForestRegressor(), LinearRegression(), Lasso()]\nfor m in models:\n    model = type(m).__name__\n    print(f'Fitting {model}')\n\n    # .new() returns a uuid and creates an entry in the db\n    uuid = tracker.new()\n    m.fit(X_train, y_train)\n    y_pred = m.predict(X_test)\n    mse = mean_squared_error(y_test, y_pred)\n\n    # add data with the .update(uuid, {'param': 'value'}) method\n    tracker.update(uuid, {'mse': mse, 'model': model, **m.get_params()})\nOr use `.insert(uuid, params)` to supply your own ID:\nsvr = SVR()\nsvr.fit(X_train, y_train)\ny_pred = svr.predict(X_test)\nmse = mean_squared_error(y_test, y_pred)\n\ntracker.insert('my_uuid', {'mse': mse, 'model': type(svr).__name__, **svr.get_params()})\n`tracker` shows last experiments by default:\ntracker\n## Querying experiments\nordered = tracker.query(\"\"\"\nSELECT uuid,\n       json_extract(parameters, '$.model') AS model,\n       json_extract(parameters, '$.mse') AS mse\nFROM experiments\nORDER BY json_extract(parameters, '$.mse') ASC\n\"\"\")\nordered\nThe query method returns a data frame with \"uuid\" as the index:\ntype(ordered)\n## Adding comments\n\ntracker.comment(ordered.index[0], 'Best performing experiment')\nUser `tracker[uuid]` to get a single experiment:\ntracker[ordered.index[0]]\n## Getting recent experiments\n\nThe recent method also returns a data frame:\ndf = tracker.recent()\ndf\nPass `normalize=True` to convert the nested JSON dictionary into columns:\ndf = tracker.recent(normalize=True)\ndf\n# delete our example database\nfrom pathlib import Path\nPath('my_experiments.db').unlink()"}